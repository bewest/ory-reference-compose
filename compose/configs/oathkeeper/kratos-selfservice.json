[
    {
        "id": "ory:kratos:public",
        "upstream": {
            "url": "http://kratos:4433",
            "preserve_host": true,
            "strip_path": "/.ory/kratos/public"
        },
        "match": {
            "url": "http://127.0.0.1:4455/.ory/kratos/public/<**>",
            "methods": ["GET", "POST" ,"PUT", "DELETE", "PATCH"]
        },
        "authenticators": [{
            "handler": "noop"
        }],
        "authorizer": {
            "handler": "allow"
        },
        "mutators": [{
            "handler": "noop"
        }]
    },
    {
        "id": "ory:hydra:public",
        "upstream": {
            "url": "http://hydra.service.consul:4444",
            "preserve_host": true
        },
        "match": {
            "url": "http://<{hydra.service.consul,oathkeeper.service.consul,127.0.0.1}>:4455/<{userinfo,.well-known/*,oauth2/*,oauth2/fallbacks/*,oauth2/sessions/logout}>",
            "methods": ["GET", "POST" ,"PUT", "DELETE", "PATCH"]
        },
        "authenticators": [{
            "handler": "noop"
        }],
        "authorizer": {
            "handler": "allow"
        },
        "mutators": [{
            "handler": "noop"
        }]
    },
    {
        "id": "ory:kratos-selfservice-ui-node:anonymous",
        "upstream": {
            "preserve_host": true,
            "url": "http://kratos-selfservice-ui-node:4435"
        },
        "match": {
            "url": "http://127.0.0.1:4455/<{welcome,verification,error,recovery,verify,auth/*,auth/hydra/login,**.css,**.js}{/,}>",
            "methods": ["GET"]
        },
        "authenticators": [{
            "handler": "anonymous"
        }],
        "authorizer": {
            "handler": "allow"
        },
        "mutators": [{
            "handler": "noop"
        }]
    },
    {
        "id": "ory:kratos-selfservice-ui-node:protected",
        "upstream": {
            "preserve_host": true,
            "url": "http://kratos-selfservice-ui-node:4435"
        },
        "match": {
            "url": "http://127.0.0.1:4455/<{,debug,dashboard,settings,auth/hydra/consent}>",
            "methods": ["GET", "POST"]
        },
        "authenticators": [{
            "handler": "cookie_session"
        }],
        "authorizer": {
            "handler": "allow"
        },
        "mutators": [{
            "handler": "id_token"
        }],
        "errors": [{
            "handler": "redirect",
            "config": {
                "to": "http://127.0.0.1:4455/auth/login"
            }
        }]
    }
]
